
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>YouTube VIBE Index</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: sans-serif;
      padding: 2rem;
    }
    input, button {
      padding: 0.5rem;
      font-size: 1rem;
      margin: 0.5rem;
      border-radius: 8px;
      width: 80%;
    }
    .button-primary {
      background-color: #007bff;
      border: none;
      color: white;
    }
    .button-secondary {
      background-color: #6f42c1;
      border: none;
      color: white;
    }
    .button-primary:hover, .button-secondary:hover {
      opacity: 0.8;
    }
    .input-container {
      display: flex;
      flex-direction: column;
      margin-top: 1rem;
    }
    .tab-container {
      display: flex;
      justify-content: space-around;
      margin-bottom: 1rem;
    }
    .tab {
      padding: 10px;
      cursor: pointer;
      background-color: #333;
      border-radius: 8px;
    }
    .active-tab {
      background-color: #444;
    }
    .card {
      background: #1e1e1e;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 8px;
      border: 1px solid #333;
      flex: 1;
      margin-right: 1rem;
    }
    .card-container {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #444;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background: #222;
    }
    .highlight-yellow {
      color: #ffd700;
      font-weight: bold;
    }
    .highlight-orange {
      color: #ffa500;
      font-weight: bold;
      font-size: 1.2em;
    }
    .bullet-points {
      margin-top: 1rem;
      list-style-type: disc;
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <h1>YouTube VIBE Index 분석</h1>
  <div class="tab-container">
    <div class="tab active-tab" id="single-tab" onclick="showSingleAnalysis()">단일 채널 분석</div>
    <div class="tab" id="compare-tab" onclick="showCompareAnalysis()">여러 채널 비교</div>
  </div>

  <!-- 단일 채널 분석 -->
  <div id="single-analysis" class="active-tab">
    <div class="input-container">
      <input id="single-channel-url" placeholder="유튜브 채널 URL 입력" />
      <button class="button-primary" onclick="fetchSingleChannelData()">채널 분석</button>
    </div>
    <div id="single-channel-result"></div>
  </div>

  <!-- 여러 채널 비교 -->
  <div id="compare-analysis" style="display: none;">
    <div class="input-container">
      <input id="channel-url-1" placeholder="채널 URL 1 입력" />
      <input id="channel-url-2" placeholder="채널 URL 2 입력 (선택)" />
      <input id="channel-url-3" placeholder="채널 URL 3 입력 (선택)" />
      <button class="button-secondary" onclick="fetchCompareChannels()">채널 비교 분석</button>
    </div>
    <div id="compare-result" class="card-container"></div>
  </div>

  <script>
    // 여기에 API_KEY를 코드에 삽입합니다.
    const API_KEY = "AIzaSyBnzGv5joUq8cFftHTyGeTJECTLQzYxNf8"; // 이 부분에 직접 API 키를 입력

    // 여기에 API 호출 코드가 들어갑니다
    async function fetchSingleChannelData() {
      const url = document.getElementById("single-channel-url").value;
      const result = document.getElementById("single-channel-result");
      result.innerHTML = "불러오는 중...";

      const channelId = await getChannelId(url);
      if (!channelId) {
        result.innerHTML = "채널 ID를 찾을 수 없습니다.";
        return;
      }

      const channelInfo = await getChannelInfo(channelId);
      const videos = await getVideos(channelId);
      const stats = await getStats(videos.map(v => v.id.videoId));

      const E = calculateEngagementRate(stats);
      const V = calculateViewStability(stats);
      const U = calculateUploadFrequency(videos);
      const VIBE = (E * 0.5 + V * 0.3 + U * 0.2).toFixed(2);

      const html = `
        <div>
          <h2>${channelInfo.snippet.title}</h2>
          <p>VIBE Index: ${VIBE}</p>
        </div>
      `;

      result.innerHTML = html;
    }

    // 여기에 API 호출 함수들
    async function getChannelId(url) {
      // API 호출 코드
      const res = await fetch(`https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&q=${url}`);
      const data = await res.json();
      return data.items[0]?.id.channelId;
    }

    async function getChannelInfo(channelId) {
      const res = await fetch(`https://www.googleapis.com/youtube/v3/channels?key=${API_KEY}&id=${channelId}`);
      const data = await res.json();
      return data.items[0];
    }

    async function getVideos(channelId) {
      const res = await fetch(`https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&channelId=${channelId}&part=snippet,id`);
      const data = await res.json();
      return data.items.filter(item => item.id.videoId);
    }

    async function getStats(videoIds) {
      const res = await fetch(`https://www.googleapis.com/youtube/v3/videos?key=${API_KEY}&id=${videoIds.join(',')}&part=statistics`);
      const data = await res.json();
      return data.items;
    }

    // 여기에 추가적인 계산 함수들
    function calculateEngagementRate(stats) {
      // 참여율 계산
    }

    function calculateViewStability(stats) {
      // 조회수 안정성 계산
    }

    function calculateUploadFrequency(videos) {
      // 업로드 빈도 계산
    }
  </script>
</body>
</html>
